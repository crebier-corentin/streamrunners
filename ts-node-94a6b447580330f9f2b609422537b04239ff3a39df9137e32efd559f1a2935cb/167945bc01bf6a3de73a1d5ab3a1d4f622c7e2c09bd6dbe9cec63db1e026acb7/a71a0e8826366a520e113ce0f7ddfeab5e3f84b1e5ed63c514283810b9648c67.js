"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
class BaseMigration1535611208297 {
    up(queryRunner) {
        return __awaiter(this, void 0, void 0, function* () {
            yield queryRunner.query("CREATE TABLE `stream_queue` (`id` int NOT NULL AUTO_INCREMENT, `amount` int NOT NULL DEFAULT 100, `time` int NOT NULL DEFAULT 60, `current` int NOT NULL DEFAULT 0, `start` datetime NULL, `createdAt` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), `userId` int NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB");
            yield queryRunner.query("CREATE TABLE `stream_session` (`id` int NOT NULL AUTO_INCREMENT, `amount` int NOT NULL DEFAULT 100, `start` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, `last` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, `ended` tinyint NOT NULL DEFAULT 0, `createdAt` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), `userId` int NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB");
            yield queryRunner.query("CREATE TABLE `watch_session` (`id` int NOT NULL AUTO_INCREMENT, `start` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, `last` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, `userId` int NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB");
            yield queryRunner.query("CREATE TABLE `user` (`id` int NOT NULL AUTO_INCREMENT, `twitchId` varchar(255) NOT NULL, `username` varchar(255) NOT NULL, `display_name` varchar(255) NOT NULL, `email` varchar(255) NOT NULL, `avatar` varchar(255) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB");
            yield queryRunner.query("CREATE TABLE `manual_points` (`id` int NOT NULL AUTO_INCREMENT, `amount` int NOT NULL, `createdAt` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), `userId` int NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB");
            yield queryRunner.query("ALTER TABLE `stream_queue` ADD CONSTRAINT `FK_4c57791f489aeae47721e7885c2` FOREIGN KEY (`userId`) REFERENCES `user`(`id`) ON DELETE CASCADE");
            yield queryRunner.query("ALTER TABLE `stream_session` ADD CONSTRAINT `FK_5d859efcfd20003f8d8447c875a` FOREIGN KEY (`userId`) REFERENCES `user`(`id`) ON DELETE CASCADE");
            yield queryRunner.query("ALTER TABLE `watch_session` ADD CONSTRAINT `FK_661824d1af2805b7846382d6270` FOREIGN KEY (`userId`) REFERENCES `user`(`id`) ON DELETE CASCADE");
            yield queryRunner.query("ALTER TABLE `manual_points` ADD CONSTRAINT `FK_20ad463604853de5518010becbc` FOREIGN KEY (`userId`) REFERENCES `user`(`id`) ON DELETE CASCADE");
        });
    }
    down(queryRunner) {
        return __awaiter(this, void 0, void 0, function* () {
            yield queryRunner.query("ALTER TABLE `manual_points` DROP FOREIGN KEY `FK_20ad463604853de5518010becbc`");
            yield queryRunner.query("ALTER TABLE `watch_session` DROP FOREIGN KEY `FK_661824d1af2805b7846382d6270`");
            yield queryRunner.query("ALTER TABLE `stream_session` DROP FOREIGN KEY `FK_5d859efcfd20003f8d8447c875a`");
            yield queryRunner.query("ALTER TABLE `stream_queue` DROP FOREIGN KEY `FK_4c57791f489aeae47721e7885c2`");
            yield queryRunner.query("DROP TABLE `manual_points`");
            yield queryRunner.query("DROP TABLE `user`");
            yield queryRunner.query("DROP TABLE `watch_session`");
            yield queryRunner.query("DROP TABLE `stream_session`");
            yield queryRunner.query("DROP TABLE `stream_queue`");
        });
    }
}
exports.BaseMigration1535611208297 = BaseMigration1535611208297;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1N0cmVhbVJ1bm5lcnMvVHdpdGNoVmlldy9kYXRhYmFzZS9taWdyYXRpb24vMTUzNTYxMTIwODI5Ny1CYXNlTWlncmF0aW9uLnRzIiwic291cmNlcyI6WyIvU3RyZWFtUnVubmVycy9Ud2l0Y2hWaWV3L2RhdGFiYXNlL21pZ3JhdGlvbi8xNTM1NjExMjA4Mjk3LUJhc2VNaWdyYXRpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFFQSxNQUFhLDBCQUEwQjtJQUV0QixFQUFFLENBQUMsV0FBd0I7O1lBQ3BDLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyxnVEFBZ1QsQ0FBQyxDQUFDO1lBQzFVLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyxzV0FBc1csQ0FBQyxDQUFDO1lBQ2hZLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQywrTkFBK04sQ0FBQyxDQUFDO1lBQ3pQLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyxtUUFBbVEsQ0FBQyxDQUFDO1lBQzdSLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyw0TUFBNE0sQ0FBQyxDQUFDO1lBQ3RPLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyw2SUFBNkksQ0FBQyxDQUFDO1lBQ3ZLLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQywrSUFBK0ksQ0FBQyxDQUFDO1lBQ3pLLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyw4SUFBOEksQ0FBQyxDQUFDO1lBQ3hLLE1BQU0sV0FBVyxDQUFDLEtBQUssQ0FBQyw4SUFBOEksQ0FBQyxDQUFDO1FBQzVLLENBQUM7S0FBQTtJQUVZLElBQUksQ0FBQyxXQUF3Qjs7WUFDdEMsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLCtFQUErRSxDQUFDLENBQUM7WUFDekcsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLCtFQUErRSxDQUFDLENBQUM7WUFDekcsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLGdGQUFnRixDQUFDLENBQUM7WUFDMUcsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLDhFQUE4RSxDQUFDLENBQUM7WUFDeEcsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7WUFDdEQsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLENBQUM7WUFDN0MsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7WUFDdEQsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLDZCQUE2QixDQUFDLENBQUM7WUFDdkQsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLDJCQUEyQixDQUFDLENBQUM7UUFDekQsQ0FBQztLQUFBO0NBRUo7QUExQkQsZ0VBMEJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtNaWdyYXRpb25JbnRlcmZhY2UsIFF1ZXJ5UnVubmVyfSBmcm9tIFwidHlwZW9ybVwiO1xuXG5leHBvcnQgY2xhc3MgQmFzZU1pZ3JhdGlvbjE1MzU2MTEyMDgyOTcgaW1wbGVtZW50cyBNaWdyYXRpb25JbnRlcmZhY2Uge1xuXG4gICAgcHVibGljIGFzeW5jIHVwKHF1ZXJ5UnVubmVyOiBRdWVyeVJ1bm5lcik6IFByb21pc2U8YW55PiB7XG4gICAgICAgIGF3YWl0IHF1ZXJ5UnVubmVyLnF1ZXJ5KFwiQ1JFQVRFIFRBQkxFIGBzdHJlYW1fcXVldWVgIChgaWRgIGludCBOT1QgTlVMTCBBVVRPX0lOQ1JFTUVOVCwgYGFtb3VudGAgaW50IE5PVCBOVUxMIERFRkFVTFQgMTAwLCBgdGltZWAgaW50IE5PVCBOVUxMIERFRkFVTFQgNjAsIGBjdXJyZW50YCBpbnQgTk9UIE5VTEwgREVGQVVMVCAwLCBgc3RhcnRgIGRhdGV0aW1lIE5VTEwsIGBjcmVhdGVkQXRgIGRhdGV0aW1lKDYpIE5PVCBOVUxMIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAoNiksIGB1c2VySWRgIGludCBOVUxMLCBQUklNQVJZIEtFWSAoYGlkYCkpIEVOR0lORT1Jbm5vREJcIik7XG4gICAgICAgIGF3YWl0IHF1ZXJ5UnVubmVyLnF1ZXJ5KFwiQ1JFQVRFIFRBQkxFIGBzdHJlYW1fc2Vzc2lvbmAgKGBpZGAgaW50IE5PVCBOVUxMIEFVVE9fSU5DUkVNRU5ULCBgYW1vdW50YCBpbnQgTk9UIE5VTEwgREVGQVVMVCAxMDAsIGBzdGFydGAgZGF0ZXRpbWUgTk9UIE5VTEwgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCwgYGxhc3RgIGRhdGV0aW1lIE5PVCBOVUxMIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsIGBlbmRlZGAgdGlueWludCBOT1QgTlVMTCBERUZBVUxUIDAsIGBjcmVhdGVkQXRgIGRhdGV0aW1lKDYpIE5PVCBOVUxMIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAoNiksIGB1c2VySWRgIGludCBOVUxMLCBQUklNQVJZIEtFWSAoYGlkYCkpIEVOR0lORT1Jbm5vREJcIik7XG4gICAgICAgIGF3YWl0IHF1ZXJ5UnVubmVyLnF1ZXJ5KFwiQ1JFQVRFIFRBQkxFIGB3YXRjaF9zZXNzaW9uYCAoYGlkYCBpbnQgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsIGBzdGFydGAgZGF0ZXRpbWUgTk9UIE5VTEwgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCwgYGxhc3RgIGRhdGV0aW1lIE5PVCBOVUxMIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsIGB1c2VySWRgIGludCBOVUxMLCBQUklNQVJZIEtFWSAoYGlkYCkpIEVOR0lORT1Jbm5vREJcIik7XG4gICAgICAgIGF3YWl0IHF1ZXJ5UnVubmVyLnF1ZXJ5KFwiQ1JFQVRFIFRBQkxFIGB1c2VyYCAoYGlkYCBpbnQgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsIGB0d2l0Y2hJZGAgdmFyY2hhcigyNTUpIE5PVCBOVUxMLCBgdXNlcm5hbWVgIHZhcmNoYXIoMjU1KSBOT1QgTlVMTCwgYGRpc3BsYXlfbmFtZWAgdmFyY2hhcigyNTUpIE5PVCBOVUxMLCBgZW1haWxgIHZhcmNoYXIoMjU1KSBOT1QgTlVMTCwgYGF2YXRhcmAgdmFyY2hhcigyNTUpIE5PVCBOVUxMLCBQUklNQVJZIEtFWSAoYGlkYCkpIEVOR0lORT1Jbm5vREJcIik7XG4gICAgICAgIGF3YWl0IHF1ZXJ5UnVubmVyLnF1ZXJ5KFwiQ1JFQVRFIFRBQkxFIGBtYW51YWxfcG9pbnRzYCAoYGlkYCBpbnQgTk9UIE5VTEwgQVVUT19JTkNSRU1FTlQsIGBhbW91bnRgIGludCBOT1QgTlVMTCwgYGNyZWF0ZWRBdGAgZGF0ZXRpbWUoNikgTk9UIE5VTEwgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCg2KSwgYHVzZXJJZGAgaW50IE5VTEwsIFBSSU1BUlkgS0VZIChgaWRgKSkgRU5HSU5FPUlubm9EQlwiKTtcbiAgICAgICAgYXdhaXQgcXVlcnlSdW5uZXIucXVlcnkoXCJBTFRFUiBUQUJMRSBgc3RyZWFtX3F1ZXVlYCBBREQgQ09OU1RSQUlOVCBgRktfNGM1Nzc5MWY0ODlhZWFlNDc3MjFlNzg4NWMyYCBGT1JFSUdOIEtFWSAoYHVzZXJJZGApIFJFRkVSRU5DRVMgYHVzZXJgKGBpZGApIE9OIERFTEVURSBDQVNDQURFXCIpO1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkFMVEVSIFRBQkxFIGBzdHJlYW1fc2Vzc2lvbmAgQUREIENPTlNUUkFJTlQgYEZLXzVkODU5ZWZjZmQyMDAwM2Y4ZDg0NDdjODc1YWAgRk9SRUlHTiBLRVkgKGB1c2VySWRgKSBSRUZFUkVOQ0VTIGB1c2VyYChgaWRgKSBPTiBERUxFVEUgQ0FTQ0FERVwiKTtcbiAgICAgICAgYXdhaXQgcXVlcnlSdW5uZXIucXVlcnkoXCJBTFRFUiBUQUJMRSBgd2F0Y2hfc2Vzc2lvbmAgQUREIENPTlNUUkFJTlQgYEZLXzY2MTgyNGQxYWYyODA1Yjc4NDYzODJkNjI3MGAgRk9SRUlHTiBLRVkgKGB1c2VySWRgKSBSRUZFUkVOQ0VTIGB1c2VyYChgaWRgKSBPTiBERUxFVEUgQ0FTQ0FERVwiKTtcbiAgICAgICAgYXdhaXQgcXVlcnlSdW5uZXIucXVlcnkoXCJBTFRFUiBUQUJMRSBgbWFudWFsX3BvaW50c2AgQUREIENPTlNUUkFJTlQgYEZLXzIwYWQ0NjM2MDQ4NTNkZTU1MTgwMTBiZWNiY2AgRk9SRUlHTiBLRVkgKGB1c2VySWRgKSBSRUZFUkVOQ0VTIGB1c2VyYChgaWRgKSBPTiBERUxFVEUgQ0FTQ0FERVwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZG93bihxdWVyeVJ1bm5lcjogUXVlcnlSdW5uZXIpOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkFMVEVSIFRBQkxFIGBtYW51YWxfcG9pbnRzYCBEUk9QIEZPUkVJR04gS0VZIGBGS18yMGFkNDYzNjA0ODUzZGU1NTE4MDEwYmVjYmNgXCIpO1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkFMVEVSIFRBQkxFIGB3YXRjaF9zZXNzaW9uYCBEUk9QIEZPUkVJR04gS0VZIGBGS182NjE4MjRkMWFmMjgwNWI3ODQ2MzgyZDYyNzBgXCIpO1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkFMVEVSIFRBQkxFIGBzdHJlYW1fc2Vzc2lvbmAgRFJPUCBGT1JFSUdOIEtFWSBgRktfNWQ4NTllZmNmZDIwMDAzZjhkODQ0N2M4NzVhYFwiKTtcbiAgICAgICAgYXdhaXQgcXVlcnlSdW5uZXIucXVlcnkoXCJBTFRFUiBUQUJMRSBgc3RyZWFtX3F1ZXVlYCBEUk9QIEZPUkVJR04gS0VZIGBGS180YzU3NzkxZjQ4OWFlYWU0NzcyMWU3ODg1YzJgXCIpO1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkRST1AgVEFCTEUgYG1hbnVhbF9wb2ludHNgXCIpO1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkRST1AgVEFCTEUgYHVzZXJgXCIpO1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkRST1AgVEFCTEUgYHdhdGNoX3Nlc3Npb25gXCIpO1xuICAgICAgICBhd2FpdCBxdWVyeVJ1bm5lci5xdWVyeShcIkRST1AgVEFCTEUgYHN0cmVhbV9zZXNzaW9uYFwiKTtcbiAgICAgICAgYXdhaXQgcXVlcnlSdW5uZXIucXVlcnkoXCJEUk9QIFRBQkxFIGBzdHJlYW1fcXVldWVgXCIpO1xuICAgIH1cblxufVxuIl19